<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:rich="http://richfaces.org/rich" xmlns:p="http://primefaces.org/rich">

<body>
<ui:composition template="WEB-INF/templates/template.xhtml">

    <ui:define name="title"><ui:insert name="Rich faces sample" /></ui:define>

    <ui:define name="mainContent">
    	<h1>Nouvel événement</h1>
        <div style="position:relative; width:100%; height:100%; float:left;">
		<h:form>
	        <rich:graphValidator value="#{newEvenementView}" id="gv">
	            <rich:panel header="Nouvel événement" style="width:95%" rendered="#{empty newEvenementView.success}">

	                <h:panelGrid columns="3">
	                
	                    <h:outputText value="Nom" />
		                <h:inputText label="Nom" id="nom" required="true" width="200" value="#{newEvenementView.e.nom}">
		                </h:inputText>
		                <rich:message for="nom" ajaxRendered="true" />
		                
		                <h:outputText value="Date de début" />
		                <rich:calendar value="#{newEvenementView.e.dateDebut}" id="dateDebut" locale="FR" required="true"
		                	popup="true" datePattern="d MMM yyy" todayControlMode="hidden" validatorMessage="Entrer une date."
		                	showApplyButton="false" width="200" cellWidth="24px" cellHeight="22px" style="width:200px">
		                </rich:calendar>
		                <rich:message for="dateDebut" ajaxRendered="true" />
		                
		                <h:outputText value="Date de fin" />
		                <rich:calendar value="#{newEvenementView.e.dateFin}" id="dateFin" locale="FR" required="false"
		                	popup="true" datePattern="d MMM yyy" todayControlMode="hidden"
		                	showApplyButton="false" width="200" cellWidth="24px" cellHeight="22px" style="width:200px">
		                </rich:calendar>
		                <rich:message for="dateFin" ajaxRendered="true" />
		                
		                <h:outputText value="Lieu" />
		                <h:inputText label="Lieu" id="lieu" required="true" width="200" value="#{newEvenementView.e.lieu}">
		                </h:inputText>
		                <rich:message for="lieu" ajaxRendered="true" />
		                
		                <h:outputText value="Site web" />
		                <h:inputText label="Site" id="site" required="false" width="200" value="#{newEvenementView.e.url}">
		                </h:inputText>
		                <rich:message for="site" ajaxRendered="true" />
		                
		                <h:outputText value="Organisateur" />
		                <rich:select value="#{newEvenementView.organisateur}" required="false" id="organisateur" enableManualInput="true" defaultLabel="#{newEvenementView.defaultLabelOptions}">
				        	<f:selectItems value="#{newEvenementView.associationsOptions}" />
				        </rich:select>
				        <rich:message for="organisateur" ajaxRendered="true" />
				        
		                <h:outputText value="Description" />
		                <h:inputTextarea label="Description" id="description" rows="3" cols="50" required="true" value="#{newEvenementView.e.description}">
		                </h:inputTextarea>
		                <rich:message for="description" ajaxRendered="true" />
		                
	                </h:panelGrid>

	                <a4j:commandButton value="Enregistrer" action="#{newEvenementView.record}" rendered="#{empty newEvenementView.success}">
	                	<a4j:ajax event="click" execute="@all" render="@form" />
	                </a4j:commandButton>
					<rich:messages for="gv" />
	                <rich:messages globalOnly="true" />
	                
	            </rich:panel>
                
                <h:panelGrid id="out" columns="3" rendered="#{not empty newEvenementView.success}">
	            	<h:commandLink id="cmdProfileEvenement" action="profileEvenement"  value="Voir l'événement">
			            <a4j:param name="nextEvenement" value="newEvenementView.e.id" assignTo="#{evenementView.nextEvenement}"/>
					</h:commandLink>
	            </h:panelGrid>
		            
	        </rich:graphValidator>
	        
	    </h:form>
		</div>
    </ui:define>
</ui:composition>
</body>
</html>